import{ai as $e,aj as Me,r as _,p as oe,m as Pe,M as Te,l as ke,ak as Ue,al as he,n as me,F as ae,d as ve,t as y,H as Oe,w as ge,x as t,j as Ne,am as Re,a6 as Fe,s as ye,an as we,ac as ne,a8 as _e,a9 as je,ab as X,a0 as Y,i as Ge,C as Je,c as W,ao as ue,a1 as Ee,B as ze,a5 as We,ap as Le,aq as Ke,ar as qe,as as He,at as Qe,au as Xe,ad as Ye,a as re,o as Ze,Q as el,U as ll,ae as z,W as R,X as s,af as de,av as tl,T as ce,_ as w,ag as M,aw as al,Z as m,$ as A,ax as nl}from"./index-DCsvryhv.js";import{V as Q,a as Z,b as fe,c as ee}from"./forwardRefs-DVQ9_wDa.js";import{b as ol,u as il,a as Se,V as sl,m as ul,d as Ve,e as Ce,f as rl}from"./VTextField-BK_V81Rc.js";import{V as le}from"./VDialog-eBStKkg9.js";import{V as dl}from"./VContainer-CLzposn_.js";const te=$e("v-spacer","div","VSpacer"),cl=Me("schedule",()=>{const l=_([]),S=_(!1);async function V(o){S.value=!0;try{const v=await(await fetch(`${o}/api/state`)).json();if(v.scheduleData&&Array.isArray(v.scheduleData.schedules)){const r=["IR","Red","Green","Blue","White","UV"];l.value=v.scheduleData.schedules.map(i=>({enabled:i[0],start:u(i[1]),end:u(i[2]),lights:r.filter((c,p)=>i[3+p]),title:"Untitled Schedule"}))}else l.value=[]}finally{S.value=!1}}function u(o){if(!o&&o!==0)return null;let f=Math.floor(o/100);const v=o%100;let r="AM";return f===0?f=12:f===12?r="PM":f>12&&(f-=12,r="PM"),`${String(f).padStart(2,"0")}:${String(v).padStart(2,"0")}:${r}`}return{schedules:l,loading:S,fetchSchedules:V}}),xe=Symbol.for("vuetify:selection-control-group"),Ie=oe({color:String,disabled:{type:Boolean,default:null},defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:he,trueIcon:he,ripple:{type:[Boolean,Object],default:!0},multiple:{type:Boolean,default:null},name:String,readonly:{type:Boolean,default:null},modelValue:null,type:String,valueComparator:{type:Function,default:Ue},...ke(),...Te(),...Pe()},"SelectionControlGroup"),fl=oe({...Ie({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup");me()({name:"VSelectionControlGroup",props:fl(),emits:{"update:modelValue":l=>!0},setup(l,S){let{slots:V}=S;const u=ae(l,"modelValue"),o=ve(),f=y(()=>l.id||`v-selection-control-group-${o}`),v=y(()=>l.name||f.value),r=new Set;return Ne(xe,{modelValue:u,forceUpdate:()=>{r.forEach(i=>i())},onForceUpdate:i=>{r.add(i),Re(()=>{r.delete(i)})}}),Oe({[l.defaultsTarget]:{color:y(()=>l.color),disabled:y(()=>l.disabled),density:y(()=>l.density),error:y(()=>l.error),inline:y(()=>l.inline),modelValue:u,multiple:y(()=>!!l.multiple||l.multiple==null&&Array.isArray(u.value)),name:v,falseIcon:y(()=>l.falseIcon),trueIcon:y(()=>l.trueIcon),readonly:y(()=>l.readonly),ripple:y(()=>l.ripple),type:y(()=>l.type),valueComparator:y(()=>l.valueComparator)}}),ge(()=>{var i;return t("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":l.inline},l.class],style:l.style,role:l.type==="radio"?"radiogroup":void 0},[(i=V.default)==null?void 0:i.call(V)])}),{}}});const Ae=oe({label:String,baseColor:String,trueValue:null,falseValue:null,value:null,...ke(),...Ie()},"VSelectionControl");function ml(l){const S=Ge(xe,void 0),{densityClasses:V}=Je(l),u=ae(l,"modelValue"),o=W(()=>l.trueValue!==void 0?l.trueValue:l.value!==void 0?l.value:!0),f=W(()=>l.falseValue!==void 0?l.falseValue:!1),v=W(()=>!!l.multiple||l.multiple==null&&Array.isArray(u.value)),r=W({get(){const b=S?S.modelValue.value:u.value;return v.value?ue(b).some(C=>l.valueComparator(C,o.value)):l.valueComparator(b,o.value)},set(b){if(l.readonly)return;const C=b?o.value:f.value;let x=C;v.value&&(x=b?[...ue(u.value),C]:ue(u.value).filter(k=>!l.valueComparator(k,o.value))),S?S.modelValue.value=x:u.value=x}}),{textColorClasses:i,textColorStyles:c}=Ee(()=>{if(!(l.error||l.disabled))return r.value?l.color:l.baseColor}),{backgroundColorClasses:p,backgroundColorStyles:D}=ze(()=>r.value&&!l.error&&!l.disabled?l.color:l.baseColor),F=W(()=>r.value?l.trueIcon:l.falseIcon);return{group:S,densityClasses:V,trueValue:o,falseValue:f,model:r,textColorClasses:i,textColorStyles:c,backgroundColorClasses:p,backgroundColorStyles:D,icon:F}}const be=me()({name:"VSelectionControl",directives:{Ripple:Fe},inheritAttrs:!1,props:Ae(),emits:{"update:modelValue":l=>!0},setup(l,S){let{attrs:V,slots:u}=S;const{group:o,densityClasses:f,icon:v,model:r,textColorClasses:i,textColorStyles:c,backgroundColorClasses:p,backgroundColorStyles:D,trueValue:F}=ml(l),b=ve(),C=ye(!1),x=ye(!1),k=_(),$=y(()=>l.id||`input-${b}`),P=y(()=>!l.disabled&&!l.readonly);o==null||o.onForceUpdate(()=>{k.value&&(k.value.checked=r.value)});function O(B){P.value&&(C.value=!0,Le(B.target,":focus-visible")!==!1&&(x.value=!0))}function j(){C.value=!1,x.value=!1}function N(B){B.stopPropagation()}function L(B){if(!P.value){k.value&&(k.value.checked=r.value);return}l.readonly&&o&&We(()=>o.forceUpdate()),r.value=B.target.checked}return ge(()=>{var I,T;const B=u.label?u.label({label:l.label,props:{for:$.value}}):l.label,[E,K]=we(V),G=t("input",ne({ref:k,checked:r.value,disabled:!!l.disabled,id:$.value,onBlur:j,onFocus:O,onInput:L,"aria-disabled":!!l.disabled,"aria-label":l.label,type:l.type,value:F.value,name:l.name,"aria-checked":l.type==="checkbox"?r.value:void 0},K),null);return t("div",ne({class:["v-selection-control",{"v-selection-control--dirty":r.value,"v-selection-control--disabled":l.disabled,"v-selection-control--error":l.error,"v-selection-control--focused":C.value,"v-selection-control--focus-visible":x.value,"v-selection-control--inline":l.inline},f.value,l.class]},E,{style:l.style}),[t("div",{class:["v-selection-control__wrapper",i.value],style:c.value},[(I=u.default)==null?void 0:I.call(u,{backgroundColorClasses:p,backgroundColorStyles:D}),_e(t("div",{class:["v-selection-control__input"]},[((T=u.input)==null?void 0:T.call(u,{model:r,textColorClasses:i,textColorStyles:c,backgroundColorClasses:p,backgroundColorStyles:D,inputNode:G,icon:v.value,props:{onFocus:O,onBlur:j,id:$.value}}))??t(X,null,[v.value&&t(Y,{key:"icon",icon:v.value},null),G])]),[[je("ripple"),l.ripple&&[!l.disabled&&!l.readonly,null,["center","circle"]]]])]),B&&t(ol,{for:$.value,onClick:N},{default:()=>[B]})])}),{isFocused:C,input:k}}}),vl=oe({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...ul(),...Ae()},"VSwitch"),gl=me()({name:"VSwitch",inheritAttrs:!1,props:vl(),emits:{"update:focused":l=>!0,"update:modelValue":l=>!0,"update:indeterminate":l=>!0},setup(l,S){let{attrs:V,slots:u}=S;const o=ae(l,"indeterminate"),f=ae(l,"modelValue"),{loaderClasses:v}=Ke(l),{isFocused:r,focus:i,blur:c}=il(l),p=_(),D=qe&&window.matchMedia("(forced-colors: active)").matches,F=y(()=>typeof l.loading=="string"&&l.loading!==""?l.loading:l.color),b=ve(),C=y(()=>l.id||`switch-${b}`);function x(){o.value&&(o.value=!1)}function k($){var P,O;$.stopPropagation(),$.preventDefault(),(O=(P=p.value)==null?void 0:P.input)==null||O.click()}return ge(()=>{const[$,P]=we(V),O=Se.filterProps(l),j=be.filterProps(l);return t(Se,ne({class:["v-switch",{"v-switch--flat":l.flat},{"v-switch--inset":l.inset},{"v-switch--indeterminate":o.value},v.value,l.class]},$,O,{modelValue:f.value,"onUpdate:modelValue":N=>f.value=N,id:C.value,focused:r.value,style:l.style}),{...u,default:N=>{let{id:L,messagesId:B,isDisabled:E,isReadonly:K,isValid:G}=N;const I={model:f,isValid:G};return t(be,ne({ref:p},j,{modelValue:f.value,"onUpdate:modelValue":[T=>f.value=T,x],id:L.value,"aria-describedby":B.value,type:"checkbox","aria-checked":o.value?"mixed":void 0,disabled:E.value,readonly:K.value,onFocus:i,onBlur:c},P),{...u,default:T=>{let{backgroundColorClasses:q,backgroundColorStyles:U}=T;return t("div",{class:["v-switch__track",D?void 0:q.value],style:U.value,onClick:k},[u["track-true"]&&t("div",{key:"prepend",class:"v-switch__track-true"},[u["track-true"](I)]),u["track-false"]&&t("div",{key:"append",class:"v-switch__track-false"},[u["track-false"](I)])])},input:T=>{let{inputNode:q,icon:U,backgroundColorClasses:n,backgroundColorStyles:e}=T;return t(X,null,[q,t("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":U||l.loading},l.inset||D?void 0:n.value],style:l.inset?void 0:e.value},[u.thumb?t(He,{defaults:{VIcon:{icon:U,size:"x-small"}}},{default:()=>[u.thumb({...I,icon:U})]}):t(sl,null,{default:()=>[l.loading?t(Qe,{name:"v-switch",active:!0,color:G.value===!1?void 0:F.value},{default:d=>u.loader?u.loader(d):t(Xe,{active:d.isActive,color:d.color,indeterminate:!0,size:"16",width:"2"},null)}):U&&t(Y,{key:String(U),icon:U,size:"x-small"},null)]})])])}})}})}),{}}}),pl={class:"page-root"},hl={key:0,class:"w-100 d-flex flex-column align-center"},yl={class:"mb-2"},Sl={key:1,class:"d-flex flex-column align-center justify-center"},Vl={class:"mb-2 d-flex flex-column align-center"},Cl={class:"d-flex align-center mb-2",style:{gap:"12px"}},bl={class:"d-flex align-center mb-2",style:{gap:"12px"}},kl={__name:"timer",setup(l){const S=["IR","Red","Green","Blue","White","UV"],V=`http://${window.location.hostname}:8080`,u=cl(),o=_([]),f=_(!1),v=_(!1),r=_(null),i=re({id:null,title:"Untitled Schedule",start:null,end:null,lights:[],enabled:!0}),c=re({visible:!1,type:"start",time:null,ampm:"AM"}),p=re({visible:!1,chip:"",conflictTitle:"",overlap:""});let D=null;async function F(){const e=await(await fetch(`${V}/api/state`)).json();if(e.scheduleData&&Array.isArray(e.scheduleData.schedules)){const d=["IR","Red","Green","Blue","White","UV"];o.value=e.scheduleData.schedules.map(a=>({enabled:a[0],start:b(a[1]),end:b(a[2]),lights:d.filter((g,h)=>a[3+h]),title:"Untitled Schedule"}))}else o.value=[]}Ze(()=>{u.schedules.length===0&&u.fetchSchedules(V),D=setInterval(async()=>{try{u.fetchSchedules(V);const e=await(await fetch(`${V}/api/state`)).json();if(e.scheduleData&&Array.isArray(e.scheduleData.schedules)){const d=JSON.stringify(e.scheduleData.schedules),a=JSON.stringify(C(o.value));if(d!==a){const g=["IR","Red","Green","Blue","White","UV"];o.value=e.scheduleData.schedules.map(h=>({enabled:h[0],start:b(h[1]),end:b(h[2]),lights:g.filter((H,ie)=>h[3+ie]),title:"Untitled Schedule"}))}}}catch(n){console.error("Error fetching schedule state:",n)}},1e3),F()}),el(()=>{D&&clearInterval(D)});function b(n){if(!n&&n!==0)return null;let e=Math.floor(n/100);const d=n%100;let a="AM";return e===0?e=12:e===12?a="PM":e>12&&(e-=12,a="PM"),`${String(e).padStart(2,"0")}:${String(d).padStart(2,"0")}:${a}`}function C(n){const e=["IR","Red","Green","Blue","White","UV"];function d(a){if(!a)return 0;let[g,h,H]=a.split(":");return g=parseInt(g),h=parseInt(h),H==="PM"&&g!==12&&(g+=12),H==="AM"&&g===12&&(g=0),g*100+h}return n.map(a=>[!!a.enabled,d(a.start),d(a.end),...e.map(g=>a.lights&&a.lights.includes(g))])}function x(){const n=["IR","Red","Green","Blue","White","UV"],e=JSON.parse(localStorage.getItem("lightSliderValues")||"{}");return n.map(d=>Number(e[d])||0)}async function k(n,e){const a=await(await fetch(`${V}/api/state`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lighting:n,scheduleData:e})})).json();console.log("Backend response:",a)}function $(){localStorage.setItem("schedules",JSON.stringify(o.value)),k(x(),{scheduleCount:o.value.length,schedules:C(o.value)})}function P(){f.value=!0}function O(){f.value=!1,j()}function j(n=null){v.value=!0,r.value=n,n===null?Object.assign(i,{id:Date.now(),title:"Untitled Schedule",start:null,end:null,lights:[],enabled:!0}):Object.assign(i,JSON.parse(JSON.stringify(o.value[n])))}function N(){v.value=!1,r.value=null}function L(n){j(n)}async function B(n){o.value.splice(n,1),N(),await k(x(),{scheduleCount:o.value.length,schedules:C(o.value)}),await F()}function E(n){c.type=n,c.visible=!0;const e=i[n];if(e){const[d,a,g]=e.split(":");c.time=`${d.padStart(2,"0")}:${a.padStart(2,"0")}`,c.ampm=g}else c.time="12:00",c.ampm="AM"}function K(){c.ampm=c.ampm==="AM"?"PM":"AM"}function G(){let[n,e]=c.time.split(":").map(Number);const d=c.ampm;d==="AM"?(n===0&&(n=12),n>12&&(n-=12)):(n===0&&(n=12),n<12&&(n+=12),n>12&&(n-=12)),i[c.type]=`${String(n).padStart(2,"0")}:${String(e).padStart(2,"0")}:${d}`,c.visible=!1}function I(n){if(!n)return"--:--";const[e,d,a]=n.split(":");return`${e.padStart(2,"0")}:${d.padStart(2,"0")} ${a}`}const T=W(()=>i.title&&i.start&&i.end&&i.lights.length>0);function q(){for(let n=0;n<o.value.length;n++){if(r.value!==null&&n===r.value)continue;const e=o.value[n];for(const d of i.lights)if(e.lights.includes(d)&&U(i.start,i.end,e.start,e.end)){p.chip=d,p.conflictTitle=e.title,p.overlap=`${I(e.start)} - ${I(e.end)}`,p.visible=!0;return}}r.value===null?o.value.push(JSON.parse(JSON.stringify(i))):o.value[r.value]=JSON.parse(JSON.stringify(i)),N(),k(x(),{scheduleCount:o.value.length,schedules:C(o.value)})}function U(n,e,d,a){const g=De=>{let[J,se,pe]=De.split(":");return J=parseInt(J),se=parseInt(se),pe==="PM"&&J!==12&&(J+=12),pe==="AM"&&J===12&&(J=0),J*60+se},h=g(n),H=g(e),ie=g(d),Be=g(a);return Math.max(h,ie)<Math.min(H,Be)}return(n,e)=>{const d=ll("v-time-picker");return R(),z("div",pl,[t(dl,{class:"fill-height d-flex flex-column align-center justify-center"},{default:s(()=>[o.value.length>0?(R(),z("div",hl,[(R(!0),z(X,null,de(tl(u).schedules,(a,g)=>(R(),ce(Q,{key:a.id,class:"mb-4",elevation:"4",style:{cursor:"pointer",position:"relative"},width:"400",onClick:h=>L(g)},{default:s(()=>[t(Z,{class:"d-flex justify-space-between align-center"},{default:s(()=>[w("span",null,M(a.title),1),t(gl,{modelValue:a.enabled,"onUpdate:modelValue":h=>a.enabled=h,color:a.enabled?"success":"error","hide-details":"",onChange:$,onClick:e[0]||(e[0]=al(()=>{},["stop"]))},null,8,["modelValue","onUpdate:modelValue","color"])]),_:2},1024),t(fe,null,{default:s(()=>[w("div",yl,[e[14]||(e[14]=w("strong",null,"Start:",-1)),m(" "+M(I(a.start)),1),e[15]||(e[15]=w("br",null,null,-1)),e[16]||(e[16]=w("strong",null,"End:",-1)),m(" "+M(I(a.end)),1)]),t(Ve,{column:"",multiple:""},{default:s(()=>[(R(!0),z(X,null,de(a.lights,h=>(R(),ce(Ce,{key:h,class:"ma-1",color:"primary"},{default:s(()=>[m(M(h),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t(A,{class:"my-8",color:"primary",size:"x-large",style:{"border-radius":"50%",width:"80px","aspect-ratio":"1/1"},variant:"tonal",onClick:P},{default:s(()=>[t(Y,{size:"48"},{default:s(()=>e[17]||(e[17]=[m("mdi-plus")])),_:1})]),_:1})])):(R(),z("div",Sl,[t(A,{color:"primary",size:"x-large",style:{"border-radius":"50%",width:"120px","aspect-ratio":"1/1","min-width":"0","min-height":"0",height:"auto"},variant:"tonal",onClick:P},{default:s(()=>[t(Y,{size:"64"},{default:s(()=>e[18]||(e[18]=[m("mdi-plus")])),_:1})]),_:1})])),t(le,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=a=>f.value=a),"max-width":"400",persistent:""},{default:s(()=>[t(Q,null,{default:s(()=>[t(Z,null,{default:s(()=>e[19]||(e[19]=[m("Create Schedule?")])),_:1}),t(ee,null,{default:s(()=>[t(te),t(A,{color:"primary",onClick:O},{default:s(()=>e[20]||(e[20]=[m("Yes")])),_:1}),t(A,{onClick:e[1]||(e[1]=a=>f.value=!1)},{default:s(()=>e[21]||(e[21]=[m("Cancel")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(le,{modelValue:v.value,"onUpdate:modelValue":e[8]||(e[8]=a=>v.value=a),"max-width":"400",persistent:""},{default:s(()=>[t(Q,null,{default:s(()=>[t(Z,null,{default:s(()=>[t(rl,{modelValue:i.title,"onUpdate:modelValue":e[3]||(e[3]=a=>i.title=a),"hide-details":"",label:"Title",style:{"font-size":"1.2em"},variant:"plain"},null,8,["modelValue"])]),_:1}),t(fe,null,{default:s(()=>[w("div",Vl,[w("div",Cl,[e[22]||(e[22]=w("span",null,"Start:",-1)),t(A,{color:"success",style:{"min-width":"80px"},variant:"outlined",onClick:e[4]||(e[4]=a=>E("start"))},{default:s(()=>[m(M(i.start?I(i.start):"Set Time"),1)]),_:1})]),w("div",bl,[e[23]||(e[23]=w("span",null,"End:",-1)),t(A,{color:"error",style:{"min-width":"80px"},variant:"outlined",onClick:e[5]||(e[5]=a=>E("end"))},{default:s(()=>[m(M(i.end?I(i.end):"Set Time"),1)]),_:1})]),t(Ve,{modelValue:i.lights,"onUpdate:modelValue":e[6]||(e[6]=a=>i.lights=a),class:"mb-2 d-flex flex-wrap justify-center",column:"",multiple:""},{default:s(()=>[(R(),z(X,null,de(S,a=>t(Ce,{key:a,class:"ma-1",color:"primary",size:"small",value:a,variant:i.lights.includes(a)?"elevated":"outlined"},{default:s(()=>[m(M(a),1)]),_:2},1032,["value","variant"])),64))]),_:1},8,["modelValue"])])]),_:1}),t(ee,null,{default:s(()=>[r.value!==null?(R(),ce(A,{key:0,class:"mr-auto",color:"error",variant:"tonal",onClick:e[7]||(e[7]=a=>B(r.value))},{default:s(()=>[t(Y,{start:""},{default:s(()=>e[24]||(e[24]=[m("mdi-delete")])),_:1}),e[25]||(e[25]=m(" Delete "))]),_:1})):nl("",!0),t(te),t(A,{color:"primary",disabled:!T.value,onClick:q},{default:s(()=>e[26]||(e[26]=[m("Save")])),_:1},8,["disabled"]),t(A,{onClick:N},{default:s(()=>e[27]||(e[27]=[m("Cancel")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(le,{modelValue:c.visible,"onUpdate:modelValue":e[11]||(e[11]=a=>c.visible=a),"max-width":"320",persistent:""},{default:s(()=>[t(Q,null,{default:s(()=>[t(d,{modelValue:c.time,"onUpdate:modelValue":e[9]||(e[9]=a=>c.time=a),color:c.type==="start"?"success":"error",format:"ampm","full-width":""},null,8,["modelValue","color"]),t(ee,null,{default:s(()=>[t(A,{class:"px-4",rounded:"lg",variant:"outlined",onClick:K},{default:s(()=>[m(M(c.ampm),1)]),_:1}),t(te),t(A,{color:"primary",onClick:G},{default:s(()=>e[28]||(e[28]=[m("OK")])),_:1}),t(A,{onClick:e[10]||(e[10]=a=>c.visible=!1)},{default:s(()=>e[29]||(e[29]=[m("Cancel")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(le,{modelValue:p.visible,"onUpdate:modelValue":e[13]||(e[13]=a=>p.visible=a),"max-width":"400",persistent:""},{default:s(()=>[t(Q,null,{default:s(()=>[t(Z,null,{default:s(()=>e[30]||(e[30]=[m("Schedule Conflict")])),_:1}),t(fe,null,{default:s(()=>[w("div",null,[e[31]||(e[31]=m(" This schedule with ")),w("strong",null,M(p.chip),1),e[32]||(e[32]=m(" overlaps with ")),w("strong",null,M(p.conflictTitle),1),e[33]||(e[33]=m("!")),e[34]||(e[34]=w("br",null,null,-1)),m(" Overlapping time: "+M(p.overlap),1)])]),_:1}),t(ee,null,{default:s(()=>[t(te),t(A,{color:"primary",onClick:e[12]||(e[12]=a=>p.visible=!1)},{default:s(()=>e[35]||(e[35]=[m("OK")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}},Dl=Ye(kl,[["__scopeId","data-v-634feae4"]]);export{Dl as default};
